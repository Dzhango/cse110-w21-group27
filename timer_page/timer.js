let currentTaskId,allTasks,circle,radius,circumference,distractCounter=0,isFailed=!1,isInSession=!1,isReload=!0;window.onload=function(){circle=document.getElementById("progress-ring-circle");const a=circle.getAttribute("r");radius=parseInt(a),circumference=2*radius*Math.PI,circle.style.strokeDasharray=circumference,circle.style.strokeDashoffset=0,document.getElementById("start-btn").addEventListener("click",startTimer),document.getElementById("distraction-btn").addEventListener("click",distractionCount),document.getElementById("fail-btn").addEventListener("click",displayFailModal),document.getElementById("start-short-btn").addEventListener("click",startShortBreak),document.getElementById("start-long-btn").addEventListener("click",startLongBreak),document.getElementById("continue-btn").addEventListener("click",continueTask),document.getElementById("change-btn").addEventListener("click",changeTask),document.getElementById("fail-button").addEventListener("click",failSession),document.getElementById("cancel-button").addEventListener("click",quitFailModal),localStorage.setItem("isPomo","false");const b=JSON.parse(localStorage.getItem("currentTask"));allTasks=JSON.parse(localStorage.getItem("allTasks"));for(let a=0;a<allTasks.length;a++)allTasks[a].id===b&&(currentTaskId=a,document.getElementById("currTask").innerHTML=allTasks[currentTaskId].name);resetProgressRing(),"true"===localStorage.getItem("ShortBreak")?(document.body.style.backgroundImage="linear-gradient(to right,#74EBD5,#ACB6E5)",document.getElementById("minutes").innerHTML="05",document.getElementById("seconds").innerHTML="00",document.getElementById("title_timer").innerHTML="5:00",document.getElementById("currTask").innerHTML="Short Break",document.getElementById("button-container").style.display="none",document.getElementById("container-short").style.display="block"):"true"===localStorage.getItem("LongBreak")?(document.body.style.backgroundImage="linear-gradient(to right,#ACB6E5,#74EBD5)",document.getElementById("title_timer").innerHTML="15:00",document.getElementById("minutes").innerHTML="15",document.getElementById("seconds").innerHTML="00",document.getElementById("currTask").innerHTML="Long Break",document.getElementById("button-container").style.display="none",document.getElementById("container-long").style.display="block"):(localStorage.setItem("isPomo","false"),document.getElementById("minutes").innerHTML="25",document.getElementById("seconds").innerHTML="00",document.getElementById("distraction-btn").innerHTML=`Distraction : ${distractCounter}`,document.getElementById("title_timer").innerHTML="25:00",document.getElementById("start-btn").style.display="block",document.getElementById("button-container").style.paddingLeft="0px"),window.history.pushState(null,document.title,window.location.href),window.addEventListener("popstate",()=>{isFailed?displayFailModal():window.history.back()})};function setProgress(a){circle=document.getElementById("progress-ring-circle");const b=circle.getAttribute("r"),c=parseInt(b),d=2*c*Math.PI;document.getElementById("progress-ring-circle").style.strokeDashoffset=-(a/100*d)}function resetProgressRing(){circle.style.strokeDashoffset=0}function displayBreakComplete(){const a=new Audio("../media/break-tune.mp3");a.play(),document.getElementById("breakCompleteModal").style.display="block"}function continueTask(){document.getElementById("breakCompleteModal").style.display="none",document.body.style.backgroundImage="linear-gradient(to right,#E0EAFC,#CFDEF3)",document.getElementById("currTask").innerHTML="Task",document.getElementById("button-container").style.display="flex",document.getElementById("start-btn").style.display="block",document.getElementById("button-container").style.paddingLeft="0px",resetProgressRing(),document.getElementById("distraction-btn").innerHTML=`Distraction : ${distractCounter}`,document.getElementById("title_timer").innerHTML="25:00",document.getElementById("minutes").innerHTML="25",document.getElementById("seconds").innerHTML="00",document.getElementById("currTask").innerHTML=allTasks[currentTaskId].name,localStorage.setItem("todayPomo",+localStorage.getItem("todayPomo")+1)}function changeTask(){document.getElementById("breakCompleteModal").style.display="none",window.location.href="../index.html"}function displayShortBreak(){const a=new Audio("../media/work-tune.mp3");a.play(),setTimeout(()=>{resetProgressRing(),document.body.style.backgroundImage="linear-gradient(to right,#74EBD5,#ACB6E5)",document.getElementById("minutes").innerHTML="05",document.getElementById("seconds").innerHTML="00",document.getElementById("title_timer").innerHTML="5:00",document.getElementById("currTask").innerHTML="Short Break",document.getElementById("button-container").style.display="none",document.getElementById("container-short").style.display="block"},2e3)}function startShortBreak(){document.getElementById("container-short").style.display="none",start(5,0)}function displayLongBreak(){const a=new Audio("../media/work-tune.mp3");a.play(),setTimeout(()=>{resetProgressRing(),document.body.style.backgroundImage="linear-gradient(to right,#ACB6E5,#74EBD5)",document.getElementById("minutes").innerHTML="15",document.getElementById("seconds").innerHTML="00",document.getElementById("title_timer").innerHTML="15:00",document.getElementById("currTask").innerHTML="Long Break",document.getElementById("button-container").style.display="none",document.getElementById("container-long").style.display="block"},2e3)}function startLongBreak(){document.getElementById("container-long").style.display="none",start(15,0)}function startTimer(){const a=+localStorage.getItem("todayPomo");localStorage.setItem("todayPomo",a+1),document.getElementById("distraction-btn").disabled=!1,isFailed=!0,document.getElementById("start-btn").style.display="none",document.getElementById("button-container").style.paddingLeft="150px",start(25,0)}function start(a,b){function c(){var a=Math.floor;document.getElementById("header").isNewCycle="false";const b=+new Date,c=a((b-f)/1e3),i=g-c;d=a(i/60),e=i%60;if(setProgress(100-100*(i/g)),document.getElementById("minutes").innerHTML=10>d?`0${d}`:d,!(10>e))document.getElementById("seconds").innerHTML=e,document.getElementById("title_timer").innerHTML=`${d}:${e}`;else if(document.getElementById("seconds").innerHTML=`0${e}`,document.getElementById("title_timer").innerHTML=`${d}:0${e}`,0===e&&0>=d){clearInterval(h);let a=+localStorage.getItem("sessionCounter");a+=1;let b=+localStorage.getItem("distractCounter");b+=distractCounter;const c=localStorage.getItem("isPomo");isInSession=!1,document.getElementById("distraction-btn").disabled=!0,"true"===c?(localStorage.setItem("isPomo","false"),"true"===localStorage.getItem("LongBreak")&&(document.getElementById("header").isNewCycle="true"),localStorage.setItem("ShortBreak","false"),localStorage.setItem("LongBreak","false"),displayBreakComplete()):(localStorage.setItem("isPomo","true"),document.getElementById("failModal").style.display="none",isFailed=!1,0==a%4?(document.getElementById("header").completedCycles=a,localStorage.setItem("sessionCounter",a),localStorage.setItem("distractCounter",b),localStorage.setItem("LongBreak","true"),localStorage.setItem("ShortBreak","false"),displayLongBreak()):(document.getElementById("header").completedCycles=a,localStorage.setItem("sessionCounter",a),localStorage.setItem("distractCounter",b),localStorage.setItem("ShortBreak","true"),localStorage.setItem("LongBreak","false"),displayShortBreak()),allTasks[currentTaskId].current+=1,localStorage.setItem("allTasks",JSON.stringify(allTasks)))}}let d=a,e=b;isInSession=!0;const f=+new Date;distractCounter=0,document.getElementById("distraction-btn").innerHTML=`Distraction : ${distractCounter}`;const g=60*d+e;document.getElementById("minutes").innerHTML=10>d?`0${d}`:d,10>e?(document.getElementById("seconds").innerHTML=`0${e}`,document.getElementById("title_timer").innerHTML=`${d}:0${e}`):(document.getElementById("seconds").innerHTML=e,document.getElementById("title_timer").innerHTML=`${d}:${e}`);const h=setInterval(c,500)}function distractionCount(){distractCounter+=1,document.getElementById("distraction-btn").innerHTML=`Distraction : ${distractCounter}`}function displayFailModal(){isReload=!1,document.getElementById("failModal").style.display="block"}function failSession(){document.getElementById("failModal").style.display="none",window.location.href="../index.html"}function quitFailModal(){isReload=!0,window.history.pushState(null,document.title,window.location.href),document.getElementById("failModal").style.display="none"}window.onbeforeunload=function(){if(isInSession&&isReload)return"Your timer progress will reset"},"undefined"!=typeof exports&&(module.exports={setProgress,resetProgressRing,displayBreakComplete,continueTask,changeTask,startShortBreak,startLongBreak,startTimer,start,distractionCount,displayFailModal,failSession,quitFailModal,displayShortBreak});