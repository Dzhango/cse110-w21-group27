class TaskList extends HTMLElement{constructor(){super();const a=this.attachShadow({mode:"open"});this.allTasks=null,this.dropzone=null,this.checked=!1,this.selectedNode=null,this.nodes=null,this.preNodePos=null,a.innerHTML=`<link rel="stylesheet" href="task.css"/>
      <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous"/>`}connectedCallback(){document.getElementById("taskform").addEventListener("submit",a=>this.addTask(a));const a=document.createElement("ul");a.setAttribute("id","main-list"),a.setAttribute("class","task-container d-flex"),this.shadowRoot.append(a);const b=localStorage.getItem("allTasks");if(!b||"undefined"===b)this.allTasks=[];else{this.allTasks=JSON.parse(b),0!==this.allTasks.length&&document.getElementById("welcome-message").remove();for(let a=0;a<this.allTasks.length;a++)this.renderTask(this.allTasks[a])}this.dropzone=this.shadowRoot.querySelector("ul"),this.nodes=this.dropzone.getElementsByClassName("taskNode"),this.selectedNode=null,this.preNodePos=0,this.checked=!1,this.dropzone.addEventListener("dragstart",a=>this.handleDragStart(a),!1),this.dropzone.addEventListener("dragover",a=>this.handleDragOver(a)),this.dropzone.addEventListener("drop",a=>{a.preventDefault()})}disconnectedCallback(){localStorage.setItem("allTasks",JSON.stringify(this.allTasks))}setCurrentTask(a){this.currentTask=a}renderTask(a){const b=document.createElement("task-item");b.setAttribute("id",a.id),b.name=a.name,b.current=a.current,b.number=a.number,b.completed=a.completed,b.setFunctions(this.showModalTask.bind(this),this.deleteTask.bind(this),this.editTask.bind(this),this.setCheck.bind(this)),this.shadowRoot.querySelector("ul").appendChild(b)}addTask(a){a.preventDefault();const b={id:Math.random().toString(16).slice(2),completed:!1,name:document.getElementById("task-name").value,number:document.getElementById("task-num").value,current:0,note:document.getElementById("task-note").value};this.allTasks.push(b),this.renderTask(b),document.getElementById("taskform").reset();const c=document.getElementById("welcome-message");c&&c.remove(),document.getElementById("add-task-modal").style.display="none"}deleteTask(a){document.getElementById("delete-modal").style.display="block";const b=a.target,c=b.getRootNode().host,{name:d}=c;document.getElementById("task-delete").innerText=`[${d}]`,document.getElementById("confirm-button").addEventListener("click",()=>{for(let a=0;a<this.allTasks.length;a++)if(this.allTasks[a].name===d){this.allTasks.splice(a,1);break}c.remove(),document.getElementById("delete-modal").style.display="none"})}editTask(a){const b=a.target.getRootNode().host,c=b.id,d=this.allTasks.findIndex(a=>a.id===c);document.getElementById("edit-note").value=this.allTasks[d].note,document.getElementById("edit-name").value=b.name,document.getElementById("edit-num").value=b.number;const f=document.getElementById("edit-modal");f.style.display="block";const g=document.getElementById("editform");g.addEventListener("submit",a=>{a.preventDefault();const c=g.cloneNode(!0),e=document.getElementById("edit-name").value,h=document.getElementById("edit-num").value,i=document.getElementsByClassName("edit-note").value;b.name=e,b.number=h,this.allTasks[d].name=e,this.allTasks[d].number=h,this.allTasks[d].note=i,f.style.display="none",g.parentNode.replaceChild(c,g)})}setCheck(a){const b=a.target.getRootNode().host,c=b.id;b.completed="true"===b.completed?"false":"true";const d=this.allTasks.findIndex(a=>a.id===c);this.allTasks[d].completed=!this.allTasks[d].completed}showModalTask(a){document.getElementById("play-modal").style.display="block";const b=a.target.getRootNode().host;document.getElementById("timer-name").innerText=b.name;const c=this.allTasks.findIndex(a=>a.id===b.id);document.getElementById("timer-note").innerText=this.allTasks[c].note;const d=b.id;localStorage.setItem("currentTask",JSON.stringify(d))}handleDragStart(a){this.preNodePos=this.setNodePos(a.clientY,this.preNodePos),this.selectedNode=a.target,this.checked=this.selectedNode.checkmark.checked}handleDragOver(a){a.preventDefault();const b=this.setNodePos(a.clientY,this.selectedNodePos);this.preNodePos!==b&&(this.preNodePos=this.setNodePos(a.clientY,this.preNodePos),this.dropzone.insertBefore(this.selectedNode,this.dropzone.children[b]),this.selectedNode.checkmark.checked=this.checked);const c=[];for(let b=0;b<this.nodes.length;b++){const a=this.nodes[b].id,d=this.allTasks.find(b=>b.id===a);c.push(d)}this.allTasks=c}establishNodePositions(){for(let a=0;a<this.nodes.length;a++){const b=this.nodes[a].getBoundingClientRect(),c=b.top,d=b.bottom;this.nodes[a].yPos=c+(d-c)/2}}setNodePos(a,b){this.establishNodePositions();let c,d=b;for(let e=0;e<this.nodes.length;e++)this.nodes[e].yPos<a&&(c=this.nodes[e],d=e+1);return"undefined"==typeof c&&(d=0),d}}customElements.define("task-list",TaskList),window.onbeforeunload=function(){document.getElementById("main-container").remove()},"undefined"!=typeof exports&&(module.exports={TaskList});